{"path":".obsidian/plugins/text-extractor/cache/pa/excalidraw-pasted-image-20230413215403-png-51534a301928f1555c8cd991db2f7cf0.json","text":"insert #stmtAlloc(StatID, StmtStatusID, CurrentCharges, StmtDate, StmtAllocatedsun, AvailableAllocationAnt, TotalBillingAcntCharges) select 5.5tmtID, s.StmtstatusID, s.CurrentCharges, s.StmtDate, sun(a.Amount) as StmtAllocatedsum, case when isnull(s.CurrentCharges,0)+isnull(s.TotalBillingAcntCharges,0)=0 then 0 when @PaymentAmount < @PaymentAllocatedAmount then 0 when isnull(s.CurrentCharges,0)+isnull(s. TotalBillingAcntCharges,0) < isnull(sun(a.Anount),0) then 0 --Current Charge is less than paid amount when @PaymentAmount-apaymentAllocatedAmount > (isnull(s.CurrentCharges,0)+:snull(s. TotalaillingAcntCharges,0)-isnull(sun(a. Anount),0)) then isnull(s.CurrentCharges,0)+isnull(s. TotalBillingAcntCharges,0)-isnull(sun(a. Atount),0) when @PaymentAmount-aPaymentAllocatedAmount<(isnul1(s.CurrentCharges,0)+isnul1(s. TotalBillingAcntCharges,0)-isnull(sun(a. Anount),0)) then @PaymentAmount-gPaymentAllocatedAmount else @paymentAnount-@PaymentAl locatedAmount-(i5nul1(s. CurrentCharges,0)+isnull(s. TotalillingAcntCharges,0)-isnull(sun(a. Amount), 0)) end, i5ni11(s. TotalgillingAcntCharges, 0) from retail billing.bil.tbl_statement s Teft join blu.tbl_payment_allocation 2 on s.statId = a.StmtID and isnull(a.Deleted, 0) = 0 where s.BillingAccountId - @BillingAccountID and s.stmtstatusID = 6 â€”- Only Statements with PDF Sent are selected and isnull(s.PymtAllochA, 0) = 0 group by s.StmtID, s.StmtStatusID, s.CurrentCharges, s.StmtDate, s.TotalsillingAcntCharges","libVersion":"0.0.0","langs":"eng","hash":"","size":0}